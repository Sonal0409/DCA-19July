Docker Networking:
======================

# sudo su -

# docker rm -f $(docker ps -aq)

# docker network ls

Create a custom bridge network

# docker network create --driver bridge net1

Create one more custom network:

# docker network create --driver bridge net2

# docker network ls

 place the container in the custom network

# docker run -itd --network net1 --name cont1 busybox
# docker inspect cont1

Create one more container in the same custom network:

# docker run -itd --network net1 --name cont2 busybox

Attach to anyone container:

# docker attach cont1

# ping cont2

Containers can communicate using hostnames.

Create one more container in the different custom network:

# docker run -itd --network net2 --name cont3 busybox

Attach to anyone container:

# docker attach cont3

# ping cont1

# ping cont2


We will see that cont3 cannot ping cont1 or cont2

Container can communicate within same network only


Docker-Compose Tool:
============================

 Whenever we have to deploy multiple container with a single command we will use docker-compose tool

This tool used a file with name as docker-compose.yml

This file is written in YAML which is declarative nature

In the compose file we will  declare below details for multiple microservices, 
Image details
Port details
Volume details
Network details
Command details

When the compose file is executed, it will pull the image and create containers one after the other

Using this tool, we can created dependency between containers

Using this tool, we will be able to create multi container and delete all containers

Docker-compose when executed creates a custom bridge network due to which all the container created by docker-compose tool can communicate with each other using container hostname

YAML:
=====================

YAML stands for Yet another markup langauge or YAML aint a Mark up langauge

YAML is not programming or scripting language.

It is just a format of saving data in a file.

In YAML we save data as key and value pair
A key can store single value or a list of values
The file with YAML code should have an extension of yml or YAML

while writing YAML indentation is mandatory.

Syntax in YAML file:
key: value 

Value can be a:
 - String
 - Integer
 - decimal
 - Boolean

The key will always be given to us by the tool
- keys are tool specific 

Value is always given by the admin/user 

a key: value  ==> Map 

Example 1: A key storing single value 

---
company: Simplilearn
Trainer: SonalMittal
Training: Docker 
Days: Weekdays
Time: 10AM
...

Example 2: A key storing list of values 

---
company: Simplilearn
Trainers: 
  - SonalMittal
  - Ravi
  - John
  - Rahul
Trainings: 
  - Docker 
  - kubernetes
  - Ansible
  - Jenkins
Days: 
  - Weekdays
  - Weekends
Time: 10AM
...

Example 3: A key storing list of Maps  

---
company: Simplilearn
Trainers: 
  - name: SonalMittal
    Email: Sonal@gmail.co
    phone: 3535446547
  - name: Ravi
    email: ravi@gmail.co
    phone: 43534534546



Install docker-compose tool:
*******************************************

curl -SL https://github.com/docker/compose/releases/download/v2.13.0/docker-compose-linux-x86_64 -o /usr/local/bin/docker-compose

sudo chmod +x /usr/local/bin/docker-compose

docker-compose --version


Demo for docker-compose:

# mkdir mycomposefiles
# cd mycomposefiles
# vim docker-compose.yml

version: '3'

services:
 db:
  image: mysql:5.7
  volumes:
   - db_data:/var/lib/mysql
  restart: always
  environment:
   MYSQL_ROOT_PASSWORD: password
   MYSQL_DATABASE: wordpress
   MYSQL_USER: wordpress
   MYSQL_PASSWORD: wordpress
  networks:
   - wpsite
 phpmyadmin:
  depends_on:
   - db
  image: phpmyadmin/phpmyadmin
  restart: always
  ports:
   - '8181:80'
  environment:
   PMA_HOST: db
   MYSQL_ROOT_PASSWORD: password
  networks:
   - wpsite
 Wordpress:
  depends_on:
   - db
  image: wordpress
  ports:
   - '8000:80'
  restart: always
  volumes: ['./:/var/www/html']
  environment:
   WORDPRESS_DB_HOST: db:3306
   WORDPRESS_DB_USER: wordpress
   WORDPRESS_DB_PASSWORD: wordpress
   WORDPRESS_DB_NAME: wordpress
  networks:
   - wpsite
networks:
 wpsite:
volumes:
 db_data:



# docker-compose up -d
# docker-compose ps

GO to the browser of the desktop

 Give  http://localhost:8000

On another browser give -    http://localhost:8181


# docker-compose down
